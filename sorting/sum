#!/usr/bin/env python

import sys
import shuffler

class bcolors:
    HEADER = '\033[95m'
    OKBLUE = '\033[94m'
    OKGREEN = '\033[92m'
    WARNING = '\033[93m'
    FAIL = '\033[91m'
    ENDC = '\033[0m'
    BOLD = '\033[1m'
    UNDERLINE = '\033[4m'

def get_number(s, exit_cond):
    while( True ):
        try:
            string = raw_input(s)
            if exit_cond(string):
                return None
            return int(string)
        except:
            print 'Not a number. Try again'

def ask_question(m, n, exit_cond):
    for i in range(1, 4):
        result = get_number(str(m) + ' + ' + str(n) + ' = ', exit_cond)
        if result == None:
            return -1
        
        if result == (m+n):
            print 'Correct !'
            return 1
        else:
            print 'Wrong. try again!'
            
    return 0

def run():
    print bcolors.HEADER + bcolors.UNDERLINE + 'Welcome to the Thiago\'s super sum practice!' + bcolors.ENDC
    print ''
    
    exit_cond = lambda x: x in {'q', 'quit', 'leave', 'exit'}
    number = get_number('Choose the number you want to practice sum: ', exit_cond)
    if number is None:
        return

    print 'At any time, write q or quit or exit or leave to leave'

    operands = shuffler.shuffle_numbers(range(1, 11))

    count = 0
    for operand in operands:
        ret = ask_question(number, operand, exit_cond)
        if ret == -1:
            return
        count += ret
        print ''
    
    total = len(operands)
    if count < (int(total * .7)):
        print bcolors.WARNING + 'Try harder. You got only', count, 'correct answers' + bcolors.ENDC
    else:
        print bcolors.OKGREEN + bcolors.UNDERLINE + 'Congratulations. You got', count, 'correct answers!' + bcolors.ENDC
    
    print ''
    print ''
    
run()
